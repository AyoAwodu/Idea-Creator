{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nexports.default = CollapsableHeadings;\n\nvar _slate = require(\"slate\");\n\nvar _headingToSlug = require(\"../lib/headingToSlug\");\n\nvar _headingToSlug2 = _interopRequireDefault(_headingToSlug);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction CollapsableHeadings() {\n  var queries = {\n    getPathForHeadingNode: function getPathForHeadingNode(editor, node) {\n      var slugish = (0, _headingToSlug2.default)(editor.value.document, node);\n      return (editor.props.id || window.location.pathname) + \"#\" + slugish;\n    }\n  };\n  var commands = {\n    showContentBelow: function showContentBelow(editor, node) {\n      return editor.updateContentBelow(node, false);\n    },\n    hideContentBelow: function hideContentBelow(editor, node) {\n      return editor.updateContentBelow(node, true);\n    },\n    toggleContentBelow: function toggleContentBelow(editor, node) {\n      var collapsed = node.data.get(\"collapsed\");\n      var persistKey = editor.getPathForHeadingNode(node);\n\n      if (collapsed) {\n        localStorage.removeItem(persistKey);\n        return editor.showContentBelow(node);\n      } else {\n        localStorage.setItem(persistKey, \"collapsed\");\n        return editor.hideContentBelow(node);\n      }\n    },\n    updateContentBelow: function updateContentBelow(editor, node, hidden) {\n      var document = editor.value.document;\n      editor.setNodeByKey(node.key, {\n        data: {\n          collapsed: hidden\n        }\n      });\n      var headingLevel = parseInt(node.type.replace(/^heading/, \"\"), 10);\n      var headingLevels = [];\n\n      for (var level = headingLevel; level > 0; level--) {\n        headingLevels.push(\"heading\" + level);\n      }\n\n      var active = void 0;\n      document.nodes.forEach(function (n) {\n        if (active && headingLevels.includes(n.type)) {\n          active = false;\n          return;\n        }\n\n        if (active) {\n          editor.setNodeByKey(n.key, {\n            data: _extends({}, n.data.toJS(), {\n              hidden: hidden\n            })\n          });\n        }\n\n        if (n === node) active = true;\n      });\n    }\n  };\n\n  function onKeyDown(ev, editor, next) {\n    var startBlock = editor.value.startBlock;\n    if (!startBlock || !startBlock.type || !startBlock.type.match(/heading/) || !startBlock.data.get(\"collapsed\")) return next(); // editing a heading will always uncollapse the contents beneath as the persist\n    // key is based on the slug which is based on the heading contents\n\n    editor.toggleContentBelow(startBlock);\n    return next();\n  }\n\n  function normalizeNode(node, editor, next) {\n    if (node.object !== \"block\") return next();\n\n    if (node.type.match(/heading/)) {\n      var collapsed = node.data.get(\"collapsed\");\n      var persistKey = editor.getPathForHeadingNode(node);\n      var persistedState = localStorage.getItem(persistKey);\n      var shouldBeCollapsed = persistedState === \"collapsed\"; // ensures that on load content under collapsed headings is correctly hidden\n\n      if (shouldBeCollapsed && !collapsed) {\n        return function (editor) {\n          return editor.updateContentBelow(node, shouldBeCollapsed).setNodeByKey(node.key, {\n            data: {\n              collapsed: shouldBeCollapsed\n            }\n          });\n        };\n      }\n    }\n\n    return next();\n  }\n\n  return {\n    queries: queries,\n    commands: commands,\n    normalizeNode: normalizeNode,\n    onKeyDown: onKeyDown\n  };\n}","map":{"version":3,"sources":["C:/Users/ayomi/Source/Repos/Idea-Creator/Idea-Creator/MindOverMapper_Movim/MindOverMapper_Movim/ClientApp/node_modules/awehook-rich-markdown-editor/lib/plugins/CollapsableHeadings.js"],"names":["Object","defineProperty","exports","value","_extends","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","default","CollapsableHeadings","_slate","require","_headingToSlug","_headingToSlug2","_interopRequireDefault","obj","__esModule","queries","getPathForHeadingNode","editor","node","slugish","document","props","id","window","location","pathname","commands","showContentBelow","updateContentBelow","hideContentBelow","toggleContentBelow","collapsed","data","get","persistKey","localStorage","removeItem","setItem","hidden","setNodeByKey","headingLevel","parseInt","type","replace","headingLevels","level","push","active","nodes","forEach","n","includes","toJS","onKeyDown","ev","next","startBlock","match","normalizeNode","object","persistedState","getItem","shouldBeCollapsed"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nexports.default = CollapsableHeadings;\n\nvar _slate = require(\"slate\");\n\nvar _headingToSlug = require(\"../lib/headingToSlug\");\n\nvar _headingToSlug2 = _interopRequireDefault(_headingToSlug);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction CollapsableHeadings() {\n  var queries = {\n    getPathForHeadingNode: function getPathForHeadingNode(editor, node) {\n      var slugish = (0, _headingToSlug2.default)(editor.value.document, node);\n      return (editor.props.id || window.location.pathname) + \"#\" + slugish;\n    }\n  };\n\n  var commands = {\n    showContentBelow: function showContentBelow(editor, node) {\n      return editor.updateContentBelow(node, false);\n    },\n    hideContentBelow: function hideContentBelow(editor, node) {\n      return editor.updateContentBelow(node, true);\n    },\n    toggleContentBelow: function toggleContentBelow(editor, node) {\n      var collapsed = node.data.get(\"collapsed\");\n      var persistKey = editor.getPathForHeadingNode(node);\n\n      if (collapsed) {\n        localStorage.removeItem(persistKey);\n        return editor.showContentBelow(node);\n      } else {\n        localStorage.setItem(persistKey, \"collapsed\");\n        return editor.hideContentBelow(node);\n      }\n    },\n    updateContentBelow: function updateContentBelow(editor, node, hidden) {\n      var document = editor.value.document;\n\n\n      editor.setNodeByKey(node.key, { data: { collapsed: hidden } });\n\n      var headingLevel = parseInt(node.type.replace(/^heading/, \"\"), 10);\n      var headingLevels = [];\n\n      for (var level = headingLevel; level > 0; level--) {\n        headingLevels.push(\"heading\" + level);\n      }\n\n      var active = void 0;\n      document.nodes.forEach(function (n) {\n        if (active && headingLevels.includes(n.type)) {\n          active = false;\n          return;\n        }\n        if (active) {\n          editor.setNodeByKey(n.key, { data: _extends({}, n.data.toJS(), { hidden: hidden }) });\n        }\n        if (n === node) active = true;\n      });\n    }\n  };\n\n  function onKeyDown(ev, editor, next) {\n    var startBlock = editor.value.startBlock;\n\n    if (!startBlock || !startBlock.type || !startBlock.type.match(/heading/) || !startBlock.data.get(\"collapsed\")) return next();\n\n    // editing a heading will always uncollapse the contents beneath as the persist\n    // key is based on the slug which is based on the heading contents\n    editor.toggleContentBelow(startBlock);\n    return next();\n  }\n\n  function normalizeNode(node, editor, next) {\n    if (node.object !== \"block\") return next();\n\n    if (node.type.match(/heading/)) {\n      var collapsed = node.data.get(\"collapsed\");\n      var persistKey = editor.getPathForHeadingNode(node);\n      var persistedState = localStorage.getItem(persistKey);\n      var shouldBeCollapsed = persistedState === \"collapsed\";\n\n      // ensures that on load content under collapsed headings is correctly hidden\n      if (shouldBeCollapsed && !collapsed) {\n        return function (editor) {\n          return editor.updateContentBelow(node, shouldBeCollapsed).setNodeByKey(node.key, {\n            data: { collapsed: shouldBeCollapsed }\n          });\n        };\n      }\n    }\n\n    return next();\n  }\n\n  return { queries: queries, commands: commands, normalizeNode: normalizeNode, onKeyDown: onKeyDown };\n}"]},"metadata":{},"sourceType":"script"}