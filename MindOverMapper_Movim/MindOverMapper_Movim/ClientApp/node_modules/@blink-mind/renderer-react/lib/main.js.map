{"version":3,"file":"main.js","sources":["../src/components/common/base-widget.tsx","../src/components/common/save-ref.tsx","../src/components/common/drag-scroll-widget.tsx","../src/plugins/operation.ts","../src/utils/icon.tsx","../src/utils/keys.ts","../src/utils/index.ts","../src/plugins/react/components/topic-content-widget.tsx","../src/plugins/react/components/root-widget.tsx","../src/plugins/react/components/topic-widget.tsx","../src/plugins/react/components/topic-context-menu.tsx","../src/plugins/react/components/topic-collapse-icon.tsx","../src/plugins/react/components/style-editor/style-editor.tsx","../src/plugins/react/components/topic-sub-links.tsx","../src/plugins/react/components/root-sublinks.tsx","../src/plugins/react/components/topic-highlight.tsx","../src/plugins/react/components/mind-drag-scroll-widget.tsx","../src/plugins/react/components/modals.tsx","../src/plugins/react/components/topic-desc-icon.tsx","../src/plugins/react/components/simple-text-editor.tsx","../src/plugins/react/components/simple-topic-content-editor.tsx","../src/plugins/react/components/modal-body.tsx","../src/plugins/react/components/simple-topic-desc-editor.tsx","../src/plugins/react/theme.tsx","../src/plugins/react/context-menus.tsx","../src/plugins/react/rendering.tsx","../src/plugins/react/index.ts","../src/plugins/layout.tsx","../src/plugins/style.ts","../src/plugins/event.ts","../src/plugins/hotkey.ts","../src/plugins/react/components/topic-drop-effect.tsx","../src/plugins/drag-and-drop.tsx","../src/plugins/index.ts","../src/components/diagram.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport { BaseProps } from '../base-props';\n\nexport class BaseWidget<\n  P extends BaseProps = BaseProps,\n  S = any\n> extends React.PureComponent<P, S> {\n  constructor(props: P) {\n    super(props);\n  }\n\n  operation(opType: string, arg: any) {\n    this.props.controller.run('operation', {\n      opType,\n      ...arg\n    });\n  }\n\n  run(name: string, arg: any) {\n    this.props.controller.run(name, arg);\n  }\n\n  get topic() {\n    return this.props.model.getTopic(this.props.topicKey);\n  }\n}\n","import * as React from 'react';\n\ninterface SaveRefProps {\n  children: (\n    saveRef: Function,\n    getRef: Function,\n    registerRefListener: Function\n  ) => React.ReactNode;\n}\n\ntype RefListener = (name: string, ref: HTMLElement) => void;\n\nexport class SaveRef extends React.Component<SaveRefProps> {\n  getRef = name => {\n    return this[name];\n  };\n\n  saveRef = name => {\n    return node => {\n      if (node) {\n        this[name] = node;\n        this.fireListener(name, node);\n      }\n    };\n  };\n\n  observers: Map<string, [RefListener]> = new Map();\n\n  fireListener = (name: string, ref: HTMLElement) => {\n    if (this.observers.has(name)) {\n      const listeners = this.observers.get(name);\n      for (const listener of listeners) {\n        listener(name, ref);\n      }\n    }\n  };\n\n  registerRefListener = (name, listener: RefListener) => {\n    if (!this.observers.has(name)) {\n      this.observers.set(name, [listener]);\n    } else {\n      this.observers.get(name).push(listener);\n    }\n  };\n\n  render() {\n    return this.props.children(\n      this.saveRef,\n      this.getRef,\n      this.registerRefListener.bind(this)\n    );\n  }\n}\n","import * as React from 'react';\nimport { BaseWidget } from './base-widget';\nimport ResizeObserver from 'resize-observer-polyfill';\nimport styled from 'styled-components';\n\nimport debug from 'debug';\nconst log = debug('node:drag-scroll-widget');\n\nconst DragScrollView = styled.div`\n  position: relative;\n  width: 100%;\n  height: 100%;\n  overflow: scroll;\n`;\n\nconst DragScrollContent = styled.div`\n  position: relative;\n  width: max-content;\n`;\n\ninterface DragScrollWidgetProps {\n  mouseKey?: 'left' | 'right';\n  needKeyPressed?: boolean;\n  canDragFunc?: () => Boolean;\n  children: (\n    setViewBoxScroll: (left: number, top: number) => void,\n    setViewBoxScrollDelta: (left: number, top: number) => void\n  ) => React.ReactNode;\n}\n\nexport class DragScrollWidget extends React.Component<\n  DragScrollWidgetProps,\n  any\n> {\n  constructor(props: DragScrollWidgetProps) {\n    super(props);\n    this.state = {\n      widgetStyle: {\n        width: '10000px',\n        height: '10000px'\n      }\n    };\n  }\n\n  static defaultProps = {\n    mouseKey: 'left',\n    needKeyPressed: false\n  };\n\n  contentResizeCallback = (\n    entries: ResizeObserverEntry[],\n    observer: ResizeObserver\n  ) => {\n    if (this.oldContentRect) {\n      const widgetStyle = {\n        width: this.content.clientWidth + this.viewBox.clientWidth * 2,\n        height: this.content.clientHeight + this.viewBox.clientHeight * 2\n      };\n      this.bigView.style.width = widgetStyle.width + 'px';\n      this.bigView.style.height = widgetStyle.height + 'px';\n    }\n    this.oldContentRect = entries[0].contentRect;\n  };\n\n  contentResizeObserver = new ResizeObserver(this.contentResizeCallback);\n  // oldScroll: { left: number; top: number };\n  oldContentRect: any;\n  content: HTMLElement;\n  contentRef = ref => {\n    if (ref) {\n      this.content = ref;\n      this.contentResizeObserver.observe(this.content);\n    }\n  };\n\n  viewBox: HTMLElement;\n  viewBoxRef = ref => {\n    if (ref) {\n      this.viewBox = ref;\n      this.setViewBoxScroll(\n        this.viewBox.clientWidth,\n        this.viewBox.clientHeight\n      );\n    }\n  };\n\n  bigView: HTMLElement;\n  bigViewRef = ref => {\n    if (ref) {\n      this.bigView = ref;\n    }\n  };\n\n  setWidgetStyle = () => {\n    if (this.content && this.viewBox && this.bigView) {\n      this.bigView.style.width =\n        (this.content.clientWidth + this.viewBox.clientWidth) * 2 + 'px';\n      this.bigView.style.height =\n        (this.content.clientHeight + this.viewBox.clientHeight) * 2 + 'px';\n\n      this.content.style.left = this.viewBox.clientWidth + 'px';\n      this.content.style.top = this.viewBox.clientHeight + 'px';\n    }\n  };\n\n  setViewBoxScroll = (left: number, top: number) => {\n    log(`setViewBoxScroll ${left} ${top}`);\n    if (this.viewBox) {\n      this.viewBox.scrollLeft = left;\n      this.viewBox.scrollTop = top;\n    }\n  };\n\n  setViewBoxScrollDelta = (deltaLeft: number, deltaTop: number) => {\n    log(`setViewBoxScrollDelta ${deltaLeft} ${deltaTop}`);\n    if (this.viewBox) {\n      this.viewBox.scrollLeft += deltaLeft;\n      this.viewBox.scrollTop += deltaTop;\n    }\n  };\n\n  onMouseDown = e => {\n    // log('Drag Scroll onMouseDown');\n    // log(e.nativeEvent.target);\n\n    // mouseKey 表示鼠标按下那个键才可以进行拖动，左键或者右键\n    // needKeyPressed 为了支持是否需要按下ctrl键，才可以进行拖动\n    // canDragFunc是一个函数，它是为了支持使用者以传入函数的方式，这个函数的返回值表示当前的内容是否可以被拖拽而移动\n    const { mouseKey, needKeyPressed, canDragFunc } = this.props;\n    if (canDragFunc && !canDragFunc()) return;\n    if (\n      (e.button === 0 && mouseKey === 'left') ||\n      (e.button === 2 && mouseKey === 'right')\n    ) {\n      if (needKeyPressed) {\n        if (!e.ctrlKey) return;\n      }\n      this._lastCoordX = this.viewBox.scrollLeft + e.nativeEvent.clientX;\n      this._lastCoordY = this.viewBox.scrollTop + e.nativeEvent.clientY;\n      window.addEventListener('mousemove', this.onMouseMove);\n      window.addEventListener('mouseup', this.onMouseUp);\n    }\n  };\n\n  onMouseUp = e => {\n    window.removeEventListener('mousemove', this.onMouseMove);\n    window.removeEventListener('mouseup', this.onMouseUp);\n  };\n\n  // _lastCoordX和_lastCorrdY 是为了在拖动过程中 计算 viewBox的scrollLeft和scrollTop值用到\n  // _lastCoordX和_lastCorrdY 记录下拖动开始时刻viewBox的scroll值和鼠标位置值\n  _lastCoordX: number;\n  _lastCoordY: number;\n\n  onMouseMove = (e: MouseEvent) => {\n    this.viewBox.scrollLeft = this._lastCoordX - e.clientX;\n    this.viewBox.scrollTop = this._lastCoordY - e.clientY;\n    // log(`onMouseMove ${this.viewBox.scrollLeft} ${this.viewBox.scrollTop}`);\n  };\n\n  handleContextMenu = e => {\n    e.preventDefault();\n  };\n\n  componentDidMount(): void {\n    this.setWidgetStyle();\n    document.addEventListener('contextmenu', this.handleContextMenu);\n  }\n\n  componentWillUnmount(): void {\n    document.removeEventListener('contextmenu', this.handleContextMenu);\n  }\n\n  render() {\n    return (\n      <DragScrollView ref={this.viewBoxRef} onMouseDown={this.onMouseDown}>\n        <div style={this.state.widgetStyle} ref={this.bigViewRef}>\n          <DragScrollContent\n            ref={this.contentRef}\n            style={this.state.contentStyle}\n          >\n            {this.props.children(\n              this.setViewBoxScroll,\n              this.setViewBoxScrollDelta\n            )}\n          </DragScrollContent>\n        </div>\n      </DragScrollView>\n    );\n  }\n}\n","import { ModelModifier, BlockType, FocusMode, Model } from '@blink-mind/core';\nimport { List, Stack } from 'immutable';\nimport debug from 'debug';\nconst log = debug('plugin:operation');\nexport const OpType = {\n  TOGGLE_COLLAPSE: 'TOGGLE_COLLAPSE',\n  ADD_CHILD: 'ADD_CHILD',\n  ADD_SIBLING: 'ADD_SIBLING',\n  DELETE_TOPIC: 'DELETE_TOPIC',\n  FOCUS_TOPIC: 'FOCUS_TOPIC',\n  SET_STYLE: 'SET_STYLE',\n  SET_TOPIC_CONTENT: 'SET_TOPIC_CONTENT',\n  SET_TOPIC_DESC: 'SET_TOPIC_DESC',\n  START_EDITING_CONTENT: 'START_EDITING_CONTENT',\n  START_EDITING_DESC: 'START_EDITING_DESC',\n  DRAG_AND_DROP: 'DRAG_AND_DROP'\n};\n\nexport function OperationPlugin() {\n  const startEditingContent = ({ model, topicKey }) => {\n    return ModelModifier.focusTopic({\n      model,\n      topicKey,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  };\n  const startEditingDesc = ({ model, topicKey }) => {\n    const topic = model.getTopic(topicKey);\n    const desc = topic.getBlock(BlockType.DESC);\n    if (desc.block == null || desc.block.data == null) {\n      model = ModelModifier.setDesc({ model, topicKey, desc: '' });\n    }\n    return ModelModifier.focusTopic({\n      model,\n      topicKey,\n      focusMode: FocusMode.EDITING_DESC\n    });\n  };\n\n  function dragAndDrop(props) {\n    const { srcKey, dstKey, dropDir } = props;\n    let { model } = props;\n    const srcTopic = model.getTopic(srcKey);\n    const dstTopic = model.getTopic(dstKey);\n\n    const srcParentKey = srcTopic.parentKey;\n    const srcParentTopic = model.getTopic(srcParentKey);\n    let srcParentSubKeys = srcParentTopic.subKeys;\n    const srcIndex = srcParentSubKeys.indexOf(srcKey);\n\n    srcParentSubKeys = srcParentSubKeys.delete(srcIndex);\n\n    if (dropDir === 'in') {\n      let dstSubKeys = dstTopic.subKeys;\n      dstSubKeys = dstSubKeys.push(srcKey);\n      model = model.withMutations(m => {\n        m.setIn(['topics', srcParentKey, 'subKeys'], srcParentSubKeys)\n          .setIn(['topics', srcKey, 'parentKey'], dstKey)\n          .setIn(['topics', dstKey, 'subKeys'], dstSubKeys)\n          .setIn(['topics', dstKey, 'collapse'], false);\n      });\n    } else {\n      const dstParentKey = dstTopic.parentKey;\n      const dstParentItem = model.getTopic(dstParentKey);\n      let dstParentSubKeys = dstParentItem.subKeys;\n      const dstIndex = dstParentSubKeys.indexOf(dstKey);\n      //src 和 dst 的父亲相同，这种情况要做特殊处理\n      if (srcParentKey === dstParentKey) {\n        let newDstParentSubKeys = List();\n        dstParentSubKeys.forEach(key => {\n          if (key !== srcKey) {\n            if (key === dstKey) {\n              if (dropDir === 'prev') {\n                newDstParentSubKeys = newDstParentSubKeys\n                  .push(srcKey)\n                  .push(key);\n              } else {\n                newDstParentSubKeys = newDstParentSubKeys\n                  .push(key)\n                  .push(srcKey);\n              }\n            } else {\n              newDstParentSubKeys = newDstParentSubKeys.push(key);\n            }\n          }\n        });\n        model = model.withMutations(m => {\n          m.setIn(['topics', dstParentKey, 'subKeys'], newDstParentSubKeys);\n        });\n      } else {\n        if (dropDir === 'prev') {\n          dstParentSubKeys = dstParentSubKeys.insert(dstIndex, srcKey);\n        } else if (dropDir === 'next') {\n          dstParentSubKeys = dstParentSubKeys.insert(dstIndex + 1, srcKey);\n        }\n        model = model.withMutations(m => {\n          m.setIn(['topics', srcParentKey, 'subKeys'], srcParentSubKeys)\n            .setIn(['topics', srcKey, 'parentKey'], dstParentKey)\n            .setIn(['topics', dstParentKey, 'subKeys'], dstParentSubKeys)\n            .setIn(['topics', dstParentKey, 'collapse'], false);\n        });\n      }\n    }\n    return model;\n  }\n  const OpMap = new Map([\n    [OpType.TOGGLE_COLLAPSE, ModelModifier.toggleCollapse],\n    [OpType.ADD_CHILD, ModelModifier.addChild],\n    [OpType.ADD_SIBLING, ModelModifier.addSibling],\n    [OpType.DELETE_TOPIC, ModelModifier.deleteTopic],\n    [OpType.FOCUS_TOPIC, ModelModifier.focusTopic],\n    [OpType.SET_STYLE, ModelModifier.setStyle],\n    [OpType.SET_TOPIC_CONTENT, ModelModifier.setContent],\n    [OpType.SET_TOPIC_DESC, ModelModifier.setDesc],\n    [OpType.START_EDITING_CONTENT, startEditingContent],\n    [OpType.START_EDITING_DESC, startEditingDesc],\n    [OpType.DRAG_AND_DROP, dragAndDrop]\n  ]);\n\n  let undoStack = Stack<Model>();\n  let redoStack = Stack<Model>();\n\n  return {\n    getAllowUndo(props) {\n      const { model, opType } = props;\n      if (opType) {\n        switch (opType) {\n          case OpType.FOCUS_TOPIC:\n          case OpType.START_EDITING_CONTENT:\n            return false;\n          default:\n            break;\n        }\n      }\n      return model.config.allowUndo;\n    },\n\n    getUndoRedoStack() {\n      return {\n        undoStack,\n        redoStack\n      };\n    },\n\n    setUndoStack(props) {\n      log('setUndoStack', props.undoStack);\n      undoStack = props.undoStack;\n    },\n\n    setRedoStack(props) {\n      log('setRedoStack', props.redoStack);\n      redoStack = props.redoStack;\n    },\n\n    canUndo(props) {\n      const { controller } = props;\n      const { undoStack } = controller.run('getUndoRedoStack', props);\n      const allowUndo = controller.run('getAllowUndo', props);\n      return undoStack.size > 0 && allowUndo;\n    },\n\n    canRedo(props) {\n      const { controller } = props;\n      const { redoStack } = controller.run('getUndoRedoStack', props);\n      const allowUndo = controller.run('getAllowUndo', props);\n      return redoStack.size > 0 && allowUndo;\n    },\n\n    undo(props) {\n      const { controller, model } = props;\n      if (!controller.run('getAllowUndo', props)) {\n        return;\n      }\n      const { undoStack, redoStack } = controller.run(\n        'getUndoRedoStack',\n        props\n      );\n      const newModel = undoStack.peek();\n      if (!newModel) return;\n      controller.run('setUndoStack', {\n        ...props,\n        undoStack: undoStack.shift()\n      });\n      controller.run('setRedoStack', {\n        ...props,\n        redoStack: redoStack.push(model)\n      });\n      log(newModel);\n      controller.change(newModel);\n    },\n\n    redo(props) {\n      const { controller, model } = props;\n      if (!controller.run('getAllowUndo', props)) {\n        return;\n      }\n      const { undoStack, redoStack } = controller.run(\n        'getUndoRedoStack',\n        props\n      );\n      const newModel = redoStack.peek();\n      if (!newModel) return;\n      controller.run('setUndoStack', {\n        ...props,\n        undoStack: undoStack.push(model)\n      });\n      controller.run('setRedoStack', {\n        ...props,\n        redoStack: redoStack.shift()\n      });\n      controller.change(newModel);\n    },\n\n    beforeOperation(props) {},\n    operation(props) {\n      const { opType, controller, model } = props;\n      log('operation:', opType);\n      controller.run('beforeOperation', props);\n      if (OpMap.has(opType)) {\n        if (controller.run('getAllowUndo', props)) {\n          const { undoStack } = controller.run('getUndoRedoStack', props);\n          controller.run('setUndoStack', {\n            ...props,\n            undoStack: undoStack.push(model)\n          });\n        }\n\n        const opFunc = OpMap.get(opType);\n        const newModel = opFunc(props);\n        controller.change(newModel);\n      }\n      controller.run('afterOperation', props);\n    },\n    afterOperation(props) {}\n  };\n}\n","import * as React from 'react';\nexport const IconName = {\n  SHOW_MENU: 'show-menu',\n  CLOSE: 'close',\n  COLOR_PICKER: 'color-picker',\n  NOTES: 'notes'\n};\n\nexport function iconClassName(name) {\n  return `icon iconfont bm-${name}`;\n}\n\nexport function Icon(iconName) {\n  return <span className={iconClassName(iconName)} />;\n}\n","export function contentRefKey(key) {\n  return `content-${key}`;\n}\n\nexport function topicRefKey(key) {\n  return `topic-${key}`;\n}\n\nexport function linksRefKey(key) {\n  return `links-${key}`;\n}\n\nexport function linksSvgRefKey(key) {\n  return `links-svg-${key}`;\n}\n\nexport function collapseRefKey(key) {\n  return `collapse-${key}`;\n}\n","import { KeyType } from '@blink-mind/core';\n\nexport function getLinkKey(fromKey: KeyType, toKey: KeyType) {\n  return `link-${fromKey}-${toKey}`;\n}\n\nexport type Point = {\n  x: number;\n  y: number;\n};\n\nexport function centerY(rect: ClientRect) {\n  return (rect.top + rect.bottom) / 2;\n}\n\nexport function centerX(rect: ClientRect) {\n  return (rect.left + rect.right) / 2;\n}\n\nexport function centerPointX(p1, p2) {\n  return (p1.x + p2.x) / 2;\n}\n\nexport function centerPointY(p1, p2) {\n  return (p1.y + p2.y) / 2;\n}\n\nexport * from './icon';\nexport * from './keys';\n","import * as React from 'react';\nimport styled from 'styled-components';\nimport { ContextMenuTarget } from '@blueprintjs/core';\nimport { TopicDirection, KeyType, TopicVisualLevel } from '@blink-mind/core';\nimport { BaseProps } from '../../../components/base-props';\nimport debug from 'debug';\nimport { BaseWidget } from '../../../components/common';\nimport { OpType } from '../../operation';\nimport { collapseRefKey, contentRefKey } from '../../../utils';\n\nconst log = debug('node:topic-content-widget');\n\ninterface TopicContentProps {\n  dragEnter?: boolean;\n}\n\nconst TopicContent = styled.div<TopicContentProps>`\n  display: flex;\n  align-items: center;\n  word-wrap: break-word;\n  white-space: pre-line;\n  cursor: pointer;\n  overflow: hidden;\n`;\n\nconst TopicContentWithDropArea = styled.div`\n  position: relative;\n`;\n\ninterface Props extends BaseProps {\n  draggable: boolean;\n}\n\ninterface State {\n  dragEnter: boolean;\n  showPopMenu: boolean;\n}\n\n@ContextMenuTarget\nexport class TopicContentWidget extends BaseWidget<Props, State> {\n  constructor(props) {\n    super(props);\n    this.state = {\n      dragEnter: false,\n      showPopMenu: false\n    };\n  }\n\n  onDragStart = ev => {\n    this.run('handleTopicDragStart', { ...this.props, ev });\n  };\n\n  onDragOver = ev => {\n    ev.preventDefault();\n  };\n\n  onDragEnter = ev => {\n    this.run('handleTopicDragEnter', { ...this.props, ev, dropDir: 'in' });\n  };\n\n  onDragLeave = ev => {\n    this.run('handleTopicDragLeave', { ...this.props, ev, dropDir: 'in' });\n  };\n\n  onDrop = ev => {\n    this.run('handleTopicDrop', { ...this.props, ev, dropDir: 'in' });\n  };\n\n  public renderContextMenu() {\n    const { controller } = this.props;\n    return controller.run('renderTopicContextMenu', this.props);\n  }\n\n  public onContextMenuClose() {\n    // Optional method called once the context menu is closed.\n  }\n\n  isDoubleClick: boolean;\n\n  onClick = ev => {\n    this.isDoubleClick = false;\n    log(ev.nativeEvent);\n    const props = this.props;\n    const { controller } = props;\n    setTimeout(() => {\n      if (!this.isDoubleClick) {\n        controller.run('handleTopicClick', { ...props, ev });\n      }\n    });\n  };\n\n  onDoubleClick = ev => {\n    this.isDoubleClick = true;\n    const { controller } = this.props;\n    controller.run('handleTopicDoubleClick', { ...this.props, ev });\n  };\n\n  onContextMenu = ev => {\n    const { controller } = this.props;\n    controller.run('handleTopicContextMenu', { ...this.props, ev });\n    this.setState({\n      showPopMenu: true\n    });\n  };\n\n  handlePopMenuVisibleChange = visible => {\n    this.setState({\n      showPopMenu: visible\n    });\n  };\n\n  needRelocation: boolean = false;\n  oldCollapseIconRect: ClientRect;\n\n  componentDidUpdate() {\n    if (this.needRelocation) {\n      const { getRef, topicKey, setViewBoxScrollDelta } = this.props;\n      const newRect = getRef(collapseRefKey(topicKey)).getBoundingClientRect();\n      log('newRect:', newRect);\n      log('oldRect:', this.oldCollapseIconRect);\n      setViewBoxScrollDelta(\n        newRect.left - this.oldCollapseIconRect.left,\n        newRect.top - this.oldCollapseIconRect.top\n      );\n      this.needRelocation = false;\n    }\n  }\n\n  onClickCollapse = e => {\n    e.stopPropagation();\n    const { topicKey, getRef } = this.props;\n    this.needRelocation = true;\n    this.oldCollapseIconRect = getRef(\n      collapseRefKey(topicKey)\n    ).getBoundingClientRect();\n    this.operation(OpType.TOGGLE_COLLAPSE, this.props);\n  };\n\n  render() {\n    const props = this.props;\n    const { saveRef, topicKey, model, controller, topicStyle, dir } = props;\n    const draggable = model.editingContentKey !== topicKey;\n    const showPopMenu = this.state.showPopMenu;\n    const collapseIcon = controller.run('renderTopicCollapseIcon', {\n      ...props,\n      onClickCollapse: this.onClickCollapse.bind(this)\n    });\n    log(dir);\n    const prevDropArea = controller.run('renderTopicDropArea', {\n      ...props,\n      dropDir: 'prev'\n    });\n    const nextDropArea = controller.run('renderTopicDropArea', {\n      ...props,\n      dropDir: 'next'\n    });\n    const dropEventHandlers = {\n      onDragEnter: this.onDragEnter,\n      onDragLeave: this.onDragLeave,\n      onDragOver: this.onDragOver,\n      onDrop: this.onDrop\n    };\n    return (\n      <TopicContentWithDropArea>\n        {prevDropArea}\n        <TopicContent\n          // theme={getTopicTheme(visualLevel, model.config.theme)}\n          // dragEnter={this.state.dragEnter}\n          style={topicStyle}\n          draggable={draggable}\n          ref={saveRef(contentRefKey(topicKey))}\n          onDragStart={this.onDragStart}\n          onClick={this.onClick}\n          onDoubleClick={this.onDoubleClick}\n          onContextMenu={this.onContextMenu}\n          {...dropEventHandlers}\n        >\n          {controller.run('renderBlocks', props)}\n          {showPopMenu &&\n            controller.run('renderTopicPopupMenu', {\n              ...props,\n              handleVisibleChange: this.handlePopMenuVisibleChange,\n              visible: true\n            })}\n        </TopicContent>\n        {nextDropArea}\n        {dir !== TopicDirection.MAIN && collapseIcon}\n      </TopicContentWithDropArea>\n    );\n  }\n}\n","import * as React from 'react';\nimport styled from 'styled-components';\nimport { DiagramLayoutType, KeyType, TopicDirection } from '@blink-mind/core';\nimport debug from 'debug';\nimport { BaseProps } from '../../../components/base-props';\nimport { TopicSubLinks } from './topic-sub-links';\nimport { linksRefKey, topicRefKey } from '../../../utils';\n\nconst log = debug('RootNode');\n\nconst LayerPart = styled.div`\n  display: flex;\n  position: relative;\n\n  align-items: ${props =>\n    //@ts-ignore\n    props.topicDirection === TopicDirection.LEFT ? 'flex-end' : 'flex-start'};\n  flex-direction: column;\n\n  padding: ${props =>\n    //@ts-ignore\n    props.topicDirection === TopicDirection.LEFT\n      ? '15px 60px 15px 0px'\n      : '15px 0px 15px 60px'};\n`;\n\nconst Topic = styled.div`\n  display: flex;\n  position: relative;\n  align-items: center;\n  z-index: 3;\n`;\n\ninterface Props extends BaseProps {\n  setViewBoxScroll?: (left: number, top: number) => void;\n  setViewBoxScrollDelta?: (left: number, top: number) => void;\n}\n\nexport class RootWidget extends React.Component<Props> {\n  renderPartTopics(topics: KeyType[], dir: string) {\n    const { controller, saveRef } = this.props;\n    const res = controller.run('createSubTopics', {\n      props: { ...this.props, dir, isRoot: true },\n      topics\n    });\n    if (!res) return null;\n    const { subTopics } = res;\n    const cxName = `bm-layer-${dir === TopicDirection.LEFT ? 'left' : 'right'}`;\n    return (\n      //@ts-ignore\n      <LayerPart topicDirection={dir} ref={saveRef(cxName)}>\n        {subTopics}\n      </LayerPart>\n    );\n  }\n\n  componentDidMount(): void {\n    this.layout();\n  }\n\n  componentDidUpdate(): void {\n    this.layout();\n  }\n\n  layout() {\n    const { controller } = this.props;\n    controller.run('layout', this.props);\n  }\n\n  render() {\n    log('render');\n    const props = this.props;\n    const { model, topicKey, saveRef, controller, dir } = props;\n    const topicStyle = controller.run('getTopicStyle', props);\n    const config = model.config;\n    const topicContent = controller.run('renderTopicContent', {\n      ...props,\n      topicStyle,\n      dir: TopicDirection.MAIN\n    });\n    const partTopics = controller.run('getPartTopics', {\n      layout: config.layoutDir,\n      model,\n      topicKey\n    });\n    const rootTopic = (\n      <Topic ref={saveRef(topicRefKey(topicKey))}>{topicContent}</Topic>\n    );\n    const children = controller.run('renderRootWidgetOtherChildren', props);\n    switch (config.layoutDir) {\n      case DiagramLayoutType.LEFT_AND_RIGHT:\n        return (\n          <>\n            {this.renderPartTopics(partTopics.L, 'L')}\n            {rootTopic}\n            {this.renderPartTopics(partTopics.R, 'R')}\n            {children}\n          </>\n        );\n      case DiagramLayoutType.LEFT_TO_RIGHT:\n        return (\n          <>\n            {rootTopic}\n            {this.renderPartTopics(partTopics.R, 'R')}\n            {children}\n          </>\n        );\n      case DiagramLayoutType.RIGHT_TO_LEFT:\n        return (\n          <>\n            {this.renderPartTopics(partTopics.L, 'L')}\n            {rootTopic}\n            {children}\n          </>\n        );\n      case DiagramLayoutType.TOP_TO_BOTTOM:\n        return (\n          <>\n            {rootTopic}\n            {this.renderPartTopics(partTopics.B, 'B')}\n            {children}\n          </>\n        );\n    }\n    return null;\n  }\n}\n","import * as React from 'react';\nimport styled from 'styled-components';\nimport { TopicDirection } from '@blink-mind/core';\nimport { BaseProps } from '../../../components/base-props';\nimport { TopicSubLinks } from './topic-sub-links';\nimport debug from 'debug';\nimport { linksRefKey, topicRefKey } from '../../../utils';\n\nconst log = debug('node:topic-widget');\n\ntype NodeProps = {\n  topicDirection: string;\n};\n\nconst Node = styled.div<NodeProps>`\n  display: flex;\n  align-items: center;\n  flex-direction: ${props =>\n    props.topicDirection === TopicDirection.RIGHT ? 'row' : 'row-reverse'};\n`;\n\ninterface NodeChildrenProps {\n  dir: string;\n  marginH: number;\n}\n\n// TODO\nconst NodeChildren = styled.div<NodeChildrenProps>`\n  position: relative;\n  padding: ${props =>\n    props.dir === TopicDirection.RIGHT\n      ? `0 0 0 ${props.marginH}px`\n      : `0 ${props.marginH}px 0 0`};\n`;\n\ninterface NodeTopicProps {\n  topicDirection: string;\n}\n\nconst NodeTopic = styled.div<NodeTopicProps>`\n  display: flex;\n  position: relative;\n  align-items: center;\n\n  flex-direction: ${props =>\n    props.topicDirection === TopicDirection.RIGHT ? 'row' : 'row-reverse'};\n`;\n\ninterface Props extends BaseProps {\n  setViewBoxScroll?: (left: number, top: number) => void;\n  setViewBoxScrollDelta?: (left: number, top: number) => void;\n}\n\nexport class TopicWidget extends React.Component<Props> {\n  renderSubTopics() {\n    const props = this.props;\n    const { controller, model, topicKey, dir, saveRef, getRef } = props;\n    const topics = model.getTopic(topicKey).subKeys.toArray();\n    const res = controller.run('createSubTopics', { props, topics });\n    if (!res) return null;\n    const { subTopics } = res;\n    const subLinks = controller.run('renderSubLinks', props);\n    return (\n      <NodeChildren dir={dir} marginH={model.config.theme.marginH}>\n        {subTopics} {subLinks}\n      </NodeChildren>\n    );\n  }\n\n  componentDidUpdate(): void {\n    this.layoutLinks();\n  }\n\n  componentDidMount(): void {\n    this.layoutLinks();\n  }\n\n  layoutLinks() {\n    const { getRef, topicKey } = this.props;\n    const links: TopicSubLinks = getRef(linksRefKey(topicKey));\n    links && links.layout();\n  }\n\n  render() {\n    log('render');\n    const props = this.props;\n    const { controller, topicKey, dir, saveRef } = props;\n    const topicStyle = controller.run('getTopicStyle', props);\n    const propsMore = {\n      ...props,\n      topicStyle\n    };\n    const topicContent = controller.run('renderTopicContent', propsMore);\n\n    return (\n      <Node topicDirection={dir}>\n        <NodeTopic topicDirection={dir} ref={saveRef(topicRefKey(topicKey))}>\n          {topicContent}\n        </NodeTopic>\n        {this.renderSubTopics()}\n      </Node>\n    );\n  }\n}\n","import * as React from 'react';\nimport { Menu } from '@blueprintjs/core';\nimport { BaseWidget } from '../../../components/common';\n\nexport class TopicContextMenu extends BaseWidget {\n  render() {\n    const { controller } = this.props;\n    return (\n      <Menu>{controller.run('customizeTopicContextMenu', this.props)}</Menu>\n    );\n  }\n}\n","import * as React from 'react';\nimport styled, { css } from 'styled-components';\nimport cx from 'classnames';\nimport { TopicDirection } from '@blink-mind/core';\nimport { collapseRefKey } from '../../../utils';\n\nconst Icon = styled.div`\n  position: absolute;\n  top: calc(50% - 10px);\n  ${({ dir }) => {\n    if (dir === TopicDirection.RIGHT)\n      return css`\n        right: -25px;\n      `;\n    if (dir === TopicDirection.LEFT)\n      return css`\n        left: -25px;\n      `;\n  }};\n  border-radius: 50%;\n  width: 20px;\n  height: 20px;\n  text-align: center;\n  //@ts-ignore\n  background: ${props => props.background};\n  cursor: pointer;\n  padding: 0;\n  font-size: 14px;\n  line-height: 20px;\n  border: 0;\n  z-index: 2;\n`;\n\nexport function TopicCollapseIcon(props) {\n  const { model, topicKey, topicStyle, dir, saveRef, onClickCollapse } = props;\n  const topic = model.getTopic(topicKey);\n  return topic.subKeys.size > 0 ? (\n    <Icon\n      ref={saveRef(collapseRefKey(topicKey))}\n      onClick={onClickCollapse}\n      background={topicStyle.background}\n      dir={dir}\n      className={cx({\n        icon: true,\n        iconfont: true,\n        [`bm-${topic.collapse ? 'plus' : 'minus'}`]: true\n      })}\n    />\n  ) : null;\n}\n","import * as React from 'react';\nimport styled from 'styled-components';\nimport { Button, MenuItem, Popover } from '@blueprintjs/core';\nimport { Select } from '@blueprintjs/select';\nimport { BaseWidget } from '../../../../components/common';\nimport { SketchPicker } from 'react-color';\nimport { isEqual } from 'lodash';\nimport debug from 'debug';\nimport { OpType } from '../../../operation';\nimport { iconClassName, IconName } from '../../../../utils';\n\nconst log = debug('node:style-editor');\n\nconst StyleEditorRoot = styled.div`\n  position: absolute;\n  background: white;\n  right: 30px;\n  top: 20px;\n  border-radius: 2px;\n  z-index: 4;\n`;\n\nconst Title = styled.div`\n  height: 16px;\n`;\n\nconst CloseIcon = styled.div`\n  position: absolute;\n  right: 5px;\n  top: 5px;\n  cursor: pointer;\n  &:hover {\n    color: #1ea7fd;\n  }\n`;\n\nconst PopRoot = styled.div`\n  padding: 10px;\n`;\n\nconst ShowMenuIcon = styled.a`\n  font-size: 20px !important;\n`;\n\nconst IconBg = styled.div`\n  padding: 5px;\n  cursor: pointer;\n`;\n\nconst WithBorder = styled.div`\n  border: 1px solid grey;\n  cursor: pointer;\n  font-weight: bold;\n`;\n\nconst SettingTitle = styled.div`\n  margin-top: 10px;\n  margin-bottom: 5px;\n`;\n\nconst SettingItem = styled.span`\n  margin: 0px 10px 0px 0px;\n`;\n\nconst ColorBar = styled.div`\n  height: 3px;\n  width: 80%;\n  margin-left: 10%;\n  margin-right: 10%;\n  margin-bottom: 2px;\n  background: ${props => props.color};\n`;\n\nconst PxSelect = Select.ofType();\n\nconst renderItem = unit => (width, { handleClick, modifiers, query }) => {\n  return (\n    <MenuItem text={`${width}${unit}`} key={width} onClick={handleClick} />\n  );\n};\n\nexport class StyleEditor extends BaseWidget {\n  constructor(props) {\n    super(props);\n    this.state = {\n      showPanel: false\n    };\n  }\n\n  setShowPanel = showPanel => () => {\n    this.setState({\n      showPanel: showPanel\n    });\n  };\n\n  setStyle = obj => {\n    const style = this.topic.style;\n    const styleObj = style ? JSON.parse(style) : {};\n    const newStyleObj = {\n      ...styleObj,\n      ...obj\n    };\n    if (!isEqual(styleObj, newStyleObj)) {\n      const newStyleStr = JSON.stringify(newStyleObj);\n      this.operation(OpType.SET_STYLE, { ...this.props, style: newStyleStr });\n    }\n  };\n\n  setLinkStyle = obj => {\n    const style = this.topic.style;\n    const styleObj = style ? JSON.parse(style) : {};\n    const newStyleObj = {\n      ...styleObj,\n      linkStyle: {\n        ...styleObj.linkStyle,\n        ...obj\n      }\n    };\n    if (!isEqual(styleObj, newStyleObj)) {\n      const newStyleStr = JSON.stringify(newStyleObj);\n      this.operation(OpType.SET_STYLE, { ...this.props, style: newStyleStr });\n    }\n  };\n\n  handleBorderWidthChange = value => {\n    log('handleBorderWithChange:', value);\n    this.setStyle({ borderWidth: `${value}px` });\n  };\n\n  handleBorderStyleChange = value => {\n    this.setStyle({ borderStyle: value });\n  };\n\n  handleBorderRadiusChange = value => {\n    log('handleBorderRadiusChange:', value);\n    this.setStyle({ borderRadius: `${value}px` });\n  };\n\n  handleLinkWidthChange = value => {\n    log('handleBorderRadiusChange:', value);\n    this.setLinkStyle({ lineWidth: `${value}px` });\n  };\n\n  handleBorderColorChange = color => {\n    log(color);\n    this.setStyle({ borderColor: color.hex });\n  };\n\n  handleBackgroundColorChange = color => {\n    log(color);\n    this.setStyle({ background: color.hex });\n  };\n\n  handleLinkColorChange = color => {\n    log(color);\n    this.setLinkStyle({ lineColor: color.hex });\n  };\n\n  render() {\n    const props = this.props;\n    const { controller, model } = props;\n    if (!model.focusKey) return null;\n    const topicStyle = controller.run('getTopicStyle', props);\n    const linkStyle = topicStyle.linkStyle;\n    if (!this.state.showPanel) {\n      return (\n        <StyleEditorRoot>\n          <IconBg onClick={this.setShowPanel(true)}>\n            <ShowMenuIcon className={iconClassName(IconName.SHOW_MENU)} />\n          </IconBg>\n        </StyleEditorRoot>\n      );\n    }\n\n    const borderWidthItems = [...Array(7).keys()];\n    const borderRadiusItems = [0, 5, 10, 15, 20, 25, 30, 35];\n    const borderStyleItems = ['none', 'solid', 'dotted', 'dashed', 'double'];\n    return (\n      <StyleEditorRoot>\n        <Title>\n          <CloseIcon\n            className={iconClassName(IconName.CLOSE)}\n            onClick={this.setShowPanel(false)}\n          />\n        </Title>\n        <PopRoot>\n          <SettingTitle>Border</SettingTitle>\n          <div>\n            <SettingItem>\n              <PxSelect\n                items={borderWidthItems}\n                itemRenderer={renderItem('px')}\n                filterable={false}\n                onItemSelect={this.handleBorderWidthChange}\n              >\n                <Button\n                  text={`width: ${\n                    topicStyle.borderWidth ? topicStyle.borderWidth : '0px'\n                  }`}\n                />\n              </PxSelect>\n            </SettingItem>\n            <SettingItem>\n              <PxSelect\n                items={borderStyleItems}\n                itemRenderer={renderItem('')}\n                filterable={false}\n                onItemSelect={this.handleBorderStyleChange}\n              >\n                <Button\n                  text={`style: ${\n                    topicStyle.borderStyle ? topicStyle.borderStyle : 'none'\n                  }`}\n                />\n              </PxSelect>\n            </SettingItem>\n            <SettingItem>\n              <PxSelect\n                items={borderRadiusItems}\n                itemRenderer={renderItem('px')}\n                filterable={false}\n                onItemSelect={this.handleBorderRadiusChange}\n              >\n                <Button text={`radius: ${topicStyle.borderRadius}`} />\n              </PxSelect>\n            </SettingItem>\n            <SettingItem>\n              <Popover>\n                <WithBorder>\n                  <div className={iconClassName(IconName.COLOR_PICKER)} />\n                  <ColorBar color={topicStyle.borderColor} />\n                </WithBorder>\n                <div>\n                  <SketchPicker\n                    color={topicStyle.borderColor}\n                    onChangeComplete={this.handleBorderColorChange}\n                  />\n                </div>\n              </Popover>\n            </SettingItem>\n          </div>\n          <SettingTitle>Background</SettingTitle>\n          <div>\n            <SettingItem>\n              <Popover>\n                <WithBorder>\n                  <div className={iconClassName(IconName.COLOR_PICKER)} />\n                  <ColorBar color={topicStyle.background} />\n                </WithBorder>\n                <div>\n                  <SketchPicker\n                    color={topicStyle.background}\n                    onChangeComplete={this.handleBackgroundColorChange}\n                  />\n                </div>\n              </Popover>\n            </SettingItem>\n          </div>\n          <SettingTitle>Link</SettingTitle>\n          <div>\n            <SettingItem>\n              <PxSelect\n                items={borderWidthItems}\n                itemRenderer={renderItem('px')}\n                filterable={false}\n                onItemSelect={this.handleLinkWidthChange}\n              >\n                <Button\n                  text={`width: ${linkStyle ? linkStyle.lineWidth : '0px'}`}\n                />\n              </PxSelect>\n            </SettingItem>\n            <SettingItem>\n              <Popover>\n                <WithBorder>\n                  <div className={iconClassName(IconName.COLOR_PICKER)} />\n                  <ColorBar color={topicStyle.background} />\n                </WithBorder>\n                <div>\n                  <SketchPicker\n                    color={topicStyle.background}\n                    onChangeComplete={this.handleLinkColorChange}\n                  />\n                </div>\n              </Popover>\n            </SettingItem>\n          </div>\n        </PopRoot>\n      </StyleEditorRoot>\n    );\n  }\n}\n","import * as React from 'react';\nimport styled from 'styled-components';\nimport { TopicDirection, TopicStyle } from '@blink-mind/core';\nimport { BaseWidget } from '../../../components/common';\nimport { BaseProps } from '../../../components/base-props';\nimport {\n  Point,\n  centerX,\n  centerY,\n  centerPointX,\n  centerPointY\n} from '../../../utils';\n\nimport { collapseRefKey, contentRefKey, linksSvgRefKey } from '../../../utils';\nconst TopicLinksSvg = styled.svg`\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n`;\nimport debug from 'debug';\nconst log = debug('node:topic-sub-links');\n\ninterface Props extends BaseProps {}\n\ninterface State {\n  curves: any[];\n}\n\nexport class TopicSubLinks extends BaseWidget<Props, State> {\n  state = {\n    curves: []\n  };\n  layout() {\n    const props = this.props;\n    const { model, getRef, topicKey, dir, controller } = props;\n    const topic = model.getTopic(topicKey);\n    const content = getRef(contentRefKey(topicKey));\n    const svgRect: ClientRect = getRef(\n      linksSvgRefKey(topicKey)\n    ).getBoundingClientRect();\n    const collapseRect: ClientRect = getRef(\n      collapseRefKey(topicKey)\n    ).getBoundingClientRect();\n    const contentRect = content.getBoundingClientRect();\n\n    let p1: Point, p2: Point, p3: Point;\n\n    if (dir === TopicDirection.RIGHT) {\n      p1 = {\n        x: 0,\n        y: centerY(contentRect) - svgRect.top\n      };\n      p2 = {\n        x: collapseRect.right - svgRect.left + 10,\n        y: p1.y\n      };\n    } else if (dir === TopicDirection.LEFT) {\n      p1 = {\n        x: svgRect.right,\n        y: centerY(contentRect) - svgRect.top\n      };\n      p2 = {\n        x: collapseRect.left - svgRect.left - 10,\n        y: p1.y\n      };\n    }\n    const curves = [];\n\n    topic.subKeys.forEach(key => {\n      let curve;\n      const linkStyle = controller.run('getLinkStyle', {\n        ...props,\n        topicKey: key\n      });\n\n      const rect = getRef(contentRefKey(key)).getBoundingClientRect();\n      if (dir === TopicDirection.RIGHT) {\n        p3 = {\n          x: rect.left - svgRect.left,\n          y: centerY(rect) - svgRect.top\n        };\n      }\n      if (dir === TopicDirection.LEFT) {\n        p3 = {\n          x: rect.right - svgRect.left,\n          y: centerY(rect) - svgRect.top\n        };\n      }\n      const { lineType } = linkStyle;\n      if (lineType === 'curve') {\n        curve = `M ${p1.x} ${p1.y} L ${p2.x} ${p2.y} C ${p2.x} ${centerPointY(\n          p2,\n          p3\n        )} ${centerPointX(p2, p3)} ${p3.y} ${p3.x} ${p3.y}`;\n      } else if (lineType === 'round') {\n        const vDir = p3.y > p1.y ? 1 : -1;\n        const hDir = p3.x > p1.x ? 1 : -1;\n        const radius = linkStyle.lineRadius;\n        if (p3.y === p1.y) {\n          curve = `M ${p1.x} ${p1.y} H ${p3.x}`;\n        } else {\n          // 0 表示逆时针 1 表示顺时针\n          curve = `M ${p1.x} ${p1.y} H ${p2.x} V ${p3.y -\n            vDir * radius} A ${radius} ${radius} 0 0 ${\n            vDir * hDir === 1 ? 0 : 1\n          } ${p2.x + radius * hDir} ${p3.y} H ${p3.x}`;\n        }\n      } else if (lineType === 'line') {\n        curve = `M ${p1.x} ${p1.y} H ${p2.x} L ${p3.x} ${p3.y}`;\n      }\n\n      curves.push(\n        <path\n          key={`link-${key}`}\n          d={curve}\n          strokeWidth={linkStyle.lineWidth}\n          stroke={linkStyle.lineColor}\n          fill=\"none\"\n        />\n      );\n    });\n\n    log('curves:', curves);\n    this.setState({\n      curves\n    });\n  }\n\n  render() {\n    const { topicKey, saveRef } = this.props;\n    return (\n      <TopicLinksSvg ref={saveRef(linksSvgRefKey(topicKey))}>\n        <g>{this.state.curves}</g>\n      </TopicLinksSvg>\n    );\n  }\n}\n","import * as React from 'react';\nimport styled from 'styled-components';\nimport { TopicDirection, TopicStyle } from '@blink-mind/core';\nimport { BaseWidget } from '../../../components/common';\nimport { BaseProps } from '../../../components/base-props';\nimport {\n  Point,\n  centerX,\n  centerY,\n  centerPointX,\n  centerPointY\n} from '../../../utils';\n\nimport debug from 'debug';\nimport { contentRefKey, linksSvgRefKey } from '../../../utils';\nconst RootLinksSvg = styled.svg`\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n  pointer-events: none;\n`;\n\nconst log = debug('node:topic-sub-links');\n\ninterface Props extends BaseProps {}\n\ninterface State {\n  curves: any[];\n}\n\nexport class RootSubLinks extends BaseWidget<Props, State> {\n  state = {\n    curves: []\n  };\n\n  layout() {\n    const props = this.props;\n    const { model, getRef, topicKey, dir, controller } = props;\n    const topic = model.getTopic(topicKey);\n    const contentRect = getRef(contentRefKey(topicKey)).getBoundingClientRect();\n    const svgRect: ClientRect = getRef(\n      linksSvgRefKey(topicKey)\n    ).getBoundingClientRect();\n    let p1: Point, p2: Point;\n\n    p1 = {\n      x: centerX(contentRect) - svgRect.left,\n      y: centerY(contentRect) - svgRect.top\n    };\n    const curves = [];\n    topic.subKeys.forEach(key => {\n      const style = controller.run('getTopicStyle', {\n        ...props,\n        topicKey: key\n      });\n      const { linkStyle } = style;\n      const lineType = linkStyle.lineType;\n      const rect = getRef(contentRefKey(key)).getBoundingClientRect();\n      if (rect.left > contentRect.right) {\n        p2 = {\n          x: rect.left,\n          y: centerY(rect)\n        };\n      } else {\n        p2 = {\n          x: rect.right,\n          y: centerY(rect)\n        };\n      }\n      p2 = { x: p2.x - svgRect.left, y: p2.y - svgRect.top };\n      let curve;\n      if (lineType === 'curve') {\n        curve = `M ${p1.x} ${p1.y} C ${p1.x} ${centerPointY(\n          p1,\n          p2\n        )} ${centerPointX(p1, p2)} ${p2.y} ${p2.x} ${p2.y}`;\n      } else if (lineType === 'line') {\n        curve = `M ${p1.x} ${p1.y} L ${p2.x} ${p2.y}`;\n      } else if (lineType === 'round') {\n        const vDir = p2.y > p1.y ? 1 : -1;\n        const hDir = p2.x > p1.x ? 1 : -1;\n        const radius = linkStyle.lineRadius;\n        if (radius == null) {\n          throw new Error(\n            'link line type is round, but lineRadius is not provided!'\n          );\n        }\n        if (p2.y === p1.y) {\n          curve = `M ${p1.x} ${p1.y} H ${p2.x}`;\n        } else {\n          // 0 表示逆时针 1 表示顺时针\n          curve = `M ${p1.x} ${p1.y}  V ${p2.y -\n            vDir * radius} A ${radius} ${radius} 0 0 ${\n            vDir * hDir === 1 ? 0 : 1\n          } ${p1.x + radius * hDir} ${p2.y} H ${p2.x}`;\n        }\n      }\n      curves.push(\n        <path\n          key={`link-${key}`}\n          d={curve}\n          strokeWidth={style.linkStyle.lineWidth}\n          stroke={style.linkStyle.lineColor}\n          fill=\"none\"\n        />\n      );\n    });\n    this.setState({\n      curves\n    });\n  }\n\n  render() {\n    const { topicKey, saveRef } = this.props;\n    return (\n      <RootLinksSvg ref={saveRef(linksSvgRefKey(topicKey))}>\n        <g>{this.state.curves}</g>\n      </RootLinksSvg>\n    );\n  }\n}\n","import * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseWidget } from '../../../components/common';\nimport { contentRefKey } from '../../../utils';\nimport { BaseProps } from '../../../components/base-props';\nimport { FocusMode } from '@blink-mind/core';\n\nconst FocusHighlightSvg = styled.svg`\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n`;\n\ninterface State {\n  content: any;\n}\n\nexport class TopicHighlight extends BaseWidget<BaseProps, State> {\n  state = {\n    content: null\n  };\n\n  layout() {\n    const { getRef, model } = this.props;\n    const focusKey = model.focusKey;\n    const focusMode = model.focusMode;\n    if (!focusKey || focusMode === FocusMode.EDITING_CONTENT) {\n      this.setState({\n        content: null\n      });\n      return;\n    }\n    const contentRect = getRef(contentRefKey(focusKey)).getBoundingClientRect();\n    const svgRect = getRef('svg-highlight').getBoundingClientRect();\n    const padding = 3;\n    const x = contentRect.left - svgRect.left - padding;\n    const y = contentRect.top - svgRect.top - padding;\n    const width = contentRect.width + 2 * padding;\n    const height = contentRect.height + 2 * padding;\n    this.setState({\n      content: (\n        <rect\n          x={x}\n          y={y}\n          width={width}\n          height={height}\n          fill=\"none\"\n          stroke={model.config.theme.highlightColor}\n          strokeWidth={2}\n        />\n      )\n    });\n  }\n\n  render() {\n    const { saveRef } = this.props;\n    return (\n      <FocusHighlightSvg ref={saveRef('svg-highlight')}>\n        {this.state.content}\n      </FocusHighlightSvg>\n    );\n  }\n}\n","import * as React from 'react';\nimport styled from 'styled-components';\nimport { Controller, Model } from '@blink-mind/core';\nimport { DragScrollWidget } from '../../../components/common';\nimport { topicRefKey } from '../../../utils';\nconst NodeLayer = styled.div`\n  position: relative;\n  display: flex;\n  align-items: center;\n  padding: 5px;\n`;\n\nconst DIV = styled.div`\n  width: 100%;\n  height: 100%;\n  background: ${props => props.theme.background};\n`;\n\nexport interface MindDragScrollWidgetProps {\n  controller: Controller;\n  model: Model;\n  saveRef?: Function;\n  getRef?: Function;\n}\n\nexport class MindDragScrollWidget<\n  P extends MindDragScrollWidgetProps\n> extends React.Component<MindDragScrollWidgetProps> {\n  constructor(props: MindDragScrollWidgetProps) {\n    super(props);\n  }\n\n  componentDidMount(): void {\n    const { getRef, model } = this.props;\n    const rootTopic: HTMLElement = getRef(\n      topicRefKey(model.editorRootTopicKey)\n    );\n    const nodeLayer: HTMLElement = getRef('node-layer');\n    const rootTopicRect = rootTopic.getBoundingClientRect();\n    const nodeLayerRect = nodeLayer.getBoundingClientRect();\n    this.dragScrollWidget.setViewBoxScrollDelta(\n      0,\n      rootTopicRect.top -\n        nodeLayerRect.top -\n        this.dragScrollWidget.viewBox.getBoundingClientRect().height / 2 +\n        rootTopicRect.height\n    );\n  }\n\n  get dragScrollWidget(): DragScrollWidget {\n    return this.props.getRef('DragScrollWidget');\n  }\n\n  onClick = e => {};\n\n  render() {\n    const { saveRef, model, controller } = this.props;\n    const nodeKey = model.editorRootTopicKey;\n    return (\n      <DIV\n      // onClick={this.onClick}\n      >\n        <DragScrollWidget {...this.state} ref={saveRef('DragScrollWidget')}>\n          {(\n            setViewBoxScroll: (left: number, top: number) => void,\n            setViewBoxScrollDelta: (left: number, top: number) => void\n          ) => {\n            const rootWidgetProps = {\n              ...this.props,\n              topicKey: nodeKey,\n              setViewBoxScroll,\n              setViewBoxScrollDelta\n            };\n            return (\n              <NodeLayer ref={saveRef('node-layer')}>\n                {controller.run('renderRootWidget', rootWidgetProps)}\n              </NodeLayer>\n            );\n          }}\n        </DragScrollWidget>\n      </DIV>\n    );\n  }\n}\n","import * as React from 'react';\nimport styled from 'styled-components';\nimport { Classes, Dialog } from '@blueprintjs/core';\nimport { BaseProps } from '../../../components/base-props';\nimport { BaseWidget } from '../../../components/common';\n\ninterface Props extends BaseProps {\n  saveRef?: Function;\n}\nconst DescWrapper = styled.div`\n  border: 1px solid #d9d9d9;\n  height: calc(100% - 50px);\n  padding: 0 1rem;\n  overflow: auto;\n  margin: 0.5rem 0.5rem 0 0.5rem;\n`;\n\nexport class Modals extends BaseWidget<Props> {\n  handleClose = () => {\n    const { controller } = this.props;\n    const handleActiveModalClose = controller.run(\n      'handleActiveModalClose',\n      this.props\n    );\n\n    handleActiveModalClose && handleActiveModalClose();\n  };\n\n  render() {\n    const { controller } = this.props;\n    const onClose = controller.run('handleActiveModalClose', this.props);\n    const activeModal = controller.run('renderModal', this.props);\n    const activeModalProps = controller.run('getActiveModalProps', this.props);\n    return (\n      <Dialog\n        onClose={this.handleClose}\n        isOpen={activeModal !== null}\n        autoFocus\n        enforceFocus\n        usePortal\n        title={activeModalProps && activeModalProps.title}\n        style={activeModalProps && activeModalProps.style}\n      >\n        <div className={Classes.DIALOG_BODY} style={{ minHeight: 0 }}>\n          {activeModal}\n        </div>\n      </Dialog>\n    );\n  }\n}\n","import * as React from 'react';\nimport { iconClassName, IconName } from '../../../utils';\nimport { OpType } from '../../operation';\nimport { BlockType } from '@blink-mind/core';\nimport styled from 'styled-components';\n\nconst DescIcon = styled.div`\n  &:hover {\n  }\n`;\n\nexport function TopicDescIcon(props) {\n  const { controller, model, topicKey } = props;\n  const onClick = e => {\n    e.stopPropagation();\n    controller.run('operation', {\n      ...props,\n      opType: OpType.START_EDITING_DESC\n    });\n  };\n  const desc = model.getTopic(topicKey).getBlock(BlockType.DESC);\n  return (\n    desc.block && (\n      <DescIcon\n        onClick={onClick}\n        className={iconClassName(IconName.NOTES)}\n      ></DescIcon>\n    )\n  );\n}\n","import * as React from 'react';\nimport styled from 'styled-components';\n\nconst ContentEditable = styled.span`\n  &:focus {\n    outline: 0px;\n  }\n`;\n\ninterface Props {\n  editorValue: any;\n  readOnly: boolean;\n  onChange: Function;\n}\n\nexport class SimpleTextEditor extends React.Component<Props> {\n  domNode;\n  domNodeRef = ref => {\n    this.domNode = ref;\n  };\n  render() {\n    return (\n      <ContentEditable\n        ref={this.domNodeRef}\n        // onInput={this.emitChange}\n        onBlur={this.emitChange.bind(this)}\n        contentEditable={!this.props.readOnly}\n        suppressContentEditableWarning\n      >\n        {this.props.editorValue}\n      </ContentEditable>\n    );\n  }\n  shouldComponentUpdate(nextProps) {\n    return nextProps.html !== this.domNode.innerHTML;\n  }\n\n  lastHtml: any;\n  emitChange = () => {\n    const html = this.domNode.innerHTML;\n    if (this.props.onChange && html !== this.lastHtml) {\n      this.props.onChange(html);\n    }\n    this.lastHtml = html;\n  };\n}\n","import * as React from 'react';\nimport { BaseProps } from '../../../components/base-props';\nimport styled from 'styled-components';\nimport { Block } from '@blink-mind/core';\nimport { BaseWidget } from '../../../components/common';\nimport { OpType } from '../../operation';\nimport debug from 'debug';\nimport { SimpleTextEditor } from './simple-text-editor';\nconst log = debug('node:topic-content-editor');\n\ninterface NodeContentProps {\n  readOnly?: boolean;\n}\n\nconst NodeContent = styled.div<NodeContentProps>`\n  padding: 6px;\n  background-color: ${props => (props.readOnly ? null : 'white')};\n  color: black;\n  cursor: ${props => (props.readOnly ? 'pointer' : 'text')};\n`;\n\ninterface Props extends BaseProps {\n  block: Block;\n}\n\nexport class SimpleTopicContentEditor extends BaseWidget<Props> {\n  onMouseDown = e => {\n    e.stopPropagation();\n  };\n\n  onMouseMove = e => {\n    e.stopPropagation();\n  };\n  onChange = value => {\n    this.operation(OpType.SET_TOPIC_CONTENT, { ...this.props, content: value });\n  };\n\n  render() {\n    const { model, topicKey, saveRef, block } = this.props;\n    const content = block.data;\n    const editingContentKey = model.editingContentKey;\n\n    const readOnly = !(topicKey === editingContentKey);\n    const key = `editor-${topicKey}`;\n    return (\n      <NodeContent\n        key={key}\n        readOnly={readOnly}\n        ref={saveRef(key)}\n        onMouseDown={this.onMouseDown}\n        onMouseMove={this.onMouseMove}\n      >\n        <SimpleTextEditor\n          editorValue={content}\n          readOnly={readOnly}\n          onChange={this.onChange}\n        />\n      </NodeContent>\n    );\n  }\n}\n","import * as React from 'react';\nimport styled from 'styled-components';\n\nexport const ModalBody = styled.div`\n  height: 100%;\n  flex: 1;\n  display: flex;\n  overflow: auto;\n  background: white;\n`;\n\nexport const ModalDescEditor = styled.div`\n  padding: 6px;\n  width: 100%;\n`;\n","import * as React from 'react';\nimport { BaseProps } from '../../../components/base-props';\nimport styled from 'styled-components';\nimport { Block, BlockType } from '@blink-mind/core';\nimport { BaseWidget } from '../../../components/common';\nimport { OpType } from '../../operation';\nimport debug from 'debug';\nimport { SimpleTextEditor } from './simple-text-editor';\nconst log = debug('node:topic-content-editor');\n\ninterface NodeContentProps {\n  readOnly?: boolean;\n}\n\nconst NodeContent = styled.div<NodeContentProps>`\n  padding: 6px;\n  background-color: ${props => (props.readOnly ? null : 'white')};\n  color: black;\n  cursor: ${props => (props.readOnly ? 'pointer' : 'text')};\n`;\n\ninterface Props extends BaseProps {\n  block: Block;\n}\n\nexport class SimpleTopicDescEditor extends BaseWidget<Props> {\n  onMouseDown = e => {\n    e.stopPropagation();\n  };\n\n  onMouseMove = e => {\n    e.stopPropagation();\n  };\n  onChange = value => {\n    this.operation(OpType.SET_TOPIC_DESC, { ...this.props, desc: value });\n  };\n\n  render() {\n    const { model, topicKey, saveRef } = this.props;\n    const block = model.getTopic(topicKey).getBlock(BlockType.DESC).block;\n    const content = block.data;\n    const editingDescKey = model.editingDescKey;\n\n    const readOnly = !(topicKey === editingDescKey);\n    const key = `desc-${topicKey}`;\n    return (\n      <NodeContent\n        key={key}\n        readOnly={readOnly}\n        ref={saveRef(key)}\n        onMouseDown={this.onMouseDown}\n        onMouseMove={this.onMouseMove}\n      >\n        <SimpleTextEditor\n          editorValue={content}\n          readOnly={readOnly}\n          onChange={this.onChange}\n        />\n      </NodeContent>\n    );\n  }\n}\n","import * as React from 'react';\nimport { ThemeProvider } from 'styled-components';\n\nexport default function Theme({ theme, children }) {\n  return (\n    //@ts-ignore\n    <ThemeProvider theme={theme}>\n      <React.Fragment>{children}</React.Fragment>\n    </ThemeProvider>\n  );\n}\n","import { OpType } from '../operation';\nimport { MenuItem } from '@blueprintjs/core';\nimport { Icon } from '../../utils';\nimport * as React from 'react';\n\nexport type TopicContextMenuItemConfig = {\n  icon?: string;\n  label?: string;\n  shortcut?: string;\n  opType?: string;\n  rootCanUse?: boolean;\n  hotKey?: string;\n};\n\nconst items: TopicContextMenuItemConfig[] = [\n  {\n    icon: 'edit',\n    label: 'edit',\n    rootCanUse: true,\n    opType: OpType.START_EDITING_CONTENT\n  },\n  {\n    icon: 'add-sibling',\n    label: 'add sibling',\n    shortcut: 'enter',\n    opType: OpType.ADD_SIBLING\n  },\n  {\n    icon: 'add-child',\n    label: 'add child',\n    shortcut: 'Tab',\n    rootCanUse: true,\n    opType: OpType.ADD_CHILD\n  },\n  {\n    icon: 'notes',\n    label: 'edit notes',\n    shortcut: 'Alt + D',\n    opType: OpType.START_EDITING_DESC\n  },\n  {\n    icon: 'delete-node',\n    label: 'delete node',\n    shortcut: 'Del',\n    opType: OpType.DELETE_TOPIC\n  }\n];\n\nexport function customizeTopicContextMenu(props) {\n  const { topicKey, model, controller } = props;\n  const isRoot = topicKey === model.editorRootTopicKey;\n  function onClickItem(item) {\n    return function(e) {\n      item.opType &&\n        controller.run('operation', { ...props, opType: item.opType });\n    };\n  }\n  return items.map(item =>\n    isRoot && !item.rootCanUse ? null : (\n      <MenuItem\n        key={item.label}\n        icon={Icon(item.icon)}\n        text={item.label}\n        labelElement={<kbd>{item.shortcut}</kbd>}\n        onClick={onClickItem(item)}\n      />\n    )\n  );\n}\n","import * as React from 'react';\nimport styled from 'styled-components';\nimport { BlockType, FocusMode } from '@blink-mind/core';\nimport { TopicContentWidget } from './components/topic-content-widget';\nimport { RootWidget } from './components/root-widget';\nimport { TopicWidget } from './components/topic-widget';\nimport { TopicContextMenu } from './components/topic-context-menu';\nimport { TopicCollapseIcon } from './components/topic-collapse-icon';\nimport { StyleEditor } from './components/style-editor/style-editor';\nimport { TopicSubLinks } from './components/topic-sub-links';\nimport { RootSubLinks } from './components/root-sublinks';\nimport { linksRefKey } from '../../utils';\nimport { TopicHighlight } from './components/topic-highlight';\nimport { SaveRef } from '../../components/common';\nimport { MindDragScrollWidget } from './components/mind-drag-scroll-widget';\nimport { Modals } from './components/modals';\nimport { TopicDescIcon } from './components/topic-desc-icon';\nimport { SimpleTopicContentEditor } from './components/simple-topic-content-editor';\nimport { ModalBody, ModalDescEditor } from './components/modal-body';\nimport { SimpleTopicDescEditor } from './components/simple-topic-desc-editor';\nimport Theme from './theme';\nimport { customizeTopicContextMenu } from './context-menus';\nimport debug from 'debug';\nconst log = debug('plugin:rendering');\n\nexport function RenderingPlugin() {\n  const DiagramRoot = styled.div`\n    width: 100%;\n    height: 100%;\n    background: ${props => props.theme.background};\n    position: relative;\n  `;\n  return {\n    renderDiagram(props) {\n      const { model, controller } = props;\n      return (\n        <SaveRef>\n          {(saveRef, getRef) => {\n            const widgetProps = {\n              ...props,\n              saveRef,\n              getRef\n            };\n            log('renderDiagram', model);\n            return (\n              <Theme theme={model.config.theme}>\n                <DiagramRoot>\n                  <MindDragScrollWidget {...widgetProps} />\n                  {controller.run('renderDiagramCustomize', widgetProps)}\n                </DiagramRoot>\n              </Theme>\n            );\n          }}\n        </SaveRef>\n      );\n    },\n\n    renderDiagramCustomize(props) {\n      const { controller, model } = props;\n      const styleEditor = controller.run('renderStyleEditor', {\n        ...props,\n        topicKey: model.focusKey\n      });\n      const modals = controller.run('renderModals', {\n        ...props,\n        topicKey: model.focusKey\n      });\n      return [styleEditor, modals];\n    },\n\n    renderModals(props) {\n      return <Modals key=\"modals\" {...props} />;\n    },\n\n    renderModal(props) {\n      const { controller, model } = props;\n      const activeModalProps = controller.run('getActiveModalProps', props);\n      if (activeModalProps) {\n        if (activeModalProps.name === 'edit-desc') {\n          const modalProps = { ...props, topicKey: model.focusKey };\n          return (\n            <ModalBody>\n              <ModalDescEditor>\n                {controller.run('renderTopicDescEditor', modalProps)}\n              </ModalDescEditor>\n            </ModalBody>\n          );\n        }\n      }\n      return null;\n    },\n\n    getActiveModalProps(props) {\n      const { model } = props;\n      if (model.focusKey && model.focusMode === FocusMode.EDITING_DESC)\n        return {\n          name: 'edit-desc',\n          title: 'Edit Notes',\n          style: {\n            width: '50%',\n            height: '600px'\n          }\n        };\n      return null;\n    },\n\n    renderDoc({ children }) {\n      return children;\n    },\n\n    renderRootWidget(props) {\n      return <RootWidget {...props} />;\n    },\n\n    renderTopicWidget(props) {\n      return <TopicWidget {...props} />;\n    },\n\n    renderTopicContent(props) {\n      return <TopicContentWidget {...props} />;\n    },\n\n    renderTopicContextMenu(props) {\n      return <TopicContextMenu {...props} />;\n    },\n\n    customizeTopicContextMenu,\n\n    renderTopicContentEditor(props) {\n      log('renderTopicContentEditor', props);\n      // return <TopicContentEditor {...props} />;\n      return <SimpleTopicContentEditor {...props} />;\n    },\n\n    renderTopicDescEditor(props) {\n      return <SimpleTopicDescEditor {...props} />;\n    },\n\n    renderTopicCollapseIcon(props) {\n      return <TopicCollapseIcon {...props} />;\n    },\n\n    renderBlocks(props) {\n      const { model, topicKey, controller } = props;\n      const topic = model.getTopic(topicKey);\n      const blocks = topic.blocks;\n      const res = [];\n      let i = 0;\n      blocks.forEach(block => {\n        const b = controller.run('renderBlock', {\n          ...props,\n          block,\n          blockKey: `block-${i}`\n        });\n        if (b) {\n          res.push(<React.Fragment key={`block-${i}`}>{b}</React.Fragment>);\n          i++;\n        }\n      });\n      return res;\n    },\n\n    renderBlock(props) {\n      const { controller, block } = props;\n      switch (block.type) {\n        case BlockType.CONTENT:\n          return controller.run('renderTopicContentEditor', props);\n        case BlockType.DESC:\n          return <TopicDescIcon {...props} />;\n        default:\n          break;\n      }\n      return null;\n    },\n\n    renderSubLinks(props) {\n      const { saveRef, topicKey, model } = props;\n      const topic = model.getTopic(topicKey);\n      if (topic.subKeys.size === 0 || topic.collapse) return null;\n      return <TopicSubLinks ref={saveRef(linksRefKey(topicKey))} {...props} />;\n    },\n\n    renderRootSubLinks(props) {\n      const { saveRef, topicKey, model } = props;\n      const topic = model.getTopic(topicKey);\n      if (topic.subKeys.size === 0) return null;\n      return <RootSubLinks ref={saveRef(linksRefKey(topicKey))} {...props} />;\n    },\n\n    renderFocusItemHighlight(props) {\n      const { saveRef } = props;\n      return <TopicHighlight ref={saveRef('focus-highlight')} {...props} />;\n    },\n\n    renderRootWidgetOtherChildren(props) {\n      const { controller } = props;\n      return (\n        <>\n          {controller.run('renderRootSubLinks', props)}\n          {controller.run('renderFocusItemHighlight', props)}\n          {controller.run('renderDragAndDropEffect', props)}\n        </>\n      );\n    },\n\n    renderStyleEditor(props) {\n      return <StyleEditor key=\"style-editor\" {...props} />;\n    }\n  };\n}\n","import { RenderingPlugin } from './rendering';\n\nexport function ReactPlugin(options = {}) {\n  const renderingPlugin = RenderingPlugin();\n\n  return [renderingPlugin];\n}\n","import * as React from 'react';\nimport {\n  DiagramLayoutType,\n  Model,\n  KeyType,\n  ModelModifier\n} from '@blink-mind/core';\nimport { TopicWidget } from './react/components/topic-widget';\nimport { linksRefKey } from '../utils';\n\nexport type GetPartTopicsArg = {\n  layout: DiagramLayoutType;\n  model: Model;\n  topicKey: KeyType;\n};\nexport interface GetPartTopicsRes {\n  [part: number]: KeyType[];\n}\n\nexport function LayoutPlugin() {\n  return {\n    getPartTopics({\n      layout,\n      model,\n      topicKey\n    }: GetPartTopicsArg): GetPartTopicsRes {\n      const topic = model.getTopic(topicKey);\n      const subTopicCount = topic.subKeys.size;\n      const topics = topic.subKeys.toArray();\n      switch (layout) {\n        case DiagramLayoutType.LEFT_TO_RIGHT:\n          return { R: topics };\n        case DiagramLayoutType.RIGHT_TO_LEFT:\n          return { L: topics };\n        case DiagramLayoutType.LEFT_AND_RIGHT:\n          return {\n            L: topics.slice(Math.ceil(subTopicCount / 2), subTopicCount),\n            R: topics.slice(0, Math.ceil(subTopicCount / 2))\n          };\n        case DiagramLayoutType.TOP_TO_BOTTOM:\n          return {\n            B: topics\n          };\n      }\n    },\n\n    createSubTopics({ props, topics }) {\n      const { model, topicKey } = props;\n      const topic = model.getTopic(topicKey);\n      if (topics.size === 0 || topic.collapse) return null;\n      const subTopics = [];\n      topics.forEach(tKey => {\n        const subTopicProps = { ...props, topicKey: tKey };\n        subTopics.push(<TopicWidget key={tKey} {...subTopicProps} />);\n      });\n      return { subTopics };\n    },\n\n    layout(props) {\n      const { getRef, topicKey } = props;\n      const links = getRef(linksRefKey(topicKey));\n      const highlight = getRef('focus-highlight');\n      const dropEffect = getRef('drop-effect');\n      links && links.layout();\n      highlight && highlight.layout();\n      dropEffect && dropEffect.layout();\n    },\n\n    setLayoutDir(props) {\n      const { layoutDir, model, controller } = props;\n      controller.change(ModelModifier.setLayoutDir({ model, layoutDir }));\n    }\n  };\n}\n","import { TopicStyle, TopicVisualLevel } from '@blink-mind/core';\nimport debug from 'debug';\n\nconst log = debug('plugin:StylePlugin');\n\nexport function StylePlugin() {\n  const colorMap = new Map();\n  let colorIndex = 0;\n  return {\n    getTopicStyle(props): TopicStyle {\n      log('getTopicStyle');\n      const { topicKey, model, controller } = props;\n      const visualLevel = model.getTopicVisualLevel(topicKey);\n      const theme = model.config.theme;\n      let themeStyle;\n      if (visualLevel === TopicVisualLevel.ROOT) themeStyle = theme.rootTopic;\n      else if (visualLevel === TopicVisualLevel.PRIMARY)\n        themeStyle = theme.primaryTopic;\n      else themeStyle = theme.normalTopic;\n\n      if (theme.randomColor) {\n        const randomColor = controller.run('getRandomColor', props);\n        themeStyle = {\n          ...themeStyle,\n          background: randomColor,\n          borderColor: randomColor,\n          linkStyle: {\n            ...themeStyle.linkStyle,\n            lineColor: randomColor\n          }\n        };\n      }\n      const topic = model.getTopic(topicKey);\n      if (!topic.style) {\n        return themeStyle;\n      }\n      const customStyle = JSON.parse(topic.style);\n\n      return {\n        ...themeStyle,\n        ...customStyle,\n        linkStyle: {\n          ...themeStyle.linkStyle,\n          ...customStyle.linkStyle\n        }\n      };\n    },\n\n    getLinkStyle(props): LinkStyle {\n      const { topicKey, model, controller } = props;\n      const visualLevel = model.getTopicVisualLevel(topicKey);\n      const theme = model.config.theme;\n      let linkStyle;\n      if (visualLevel === TopicVisualLevel.ROOT)\n        linkStyle = theme.rootTopic.linkStyle;\n      else if (visualLevel === TopicVisualLevel.PRIMARY)\n        linkStyle = theme.primaryTopic.linkStyle;\n      else linkStyle = theme.normalTopic.linkStyle;\n\n      const topic = model.getTopic(topicKey);\n      if (theme.randomColor) {\n        const randomColor = controller.run('getRandomColor', {\n          ...props,\n          topicKey:\n            topic.parentKey !== model.editorRootTopicKey\n              ? topic.parentKey\n              : topicKey\n        });\n        linkStyle = {\n          ...linkStyle,\n          lineColor: randomColor\n        };\n      }\n\n      if (!topic.style) {\n        return linkStyle;\n      }\n      const customStyle = JSON.parse(topic.style);\n\n      return {\n        ...linkStyle,\n        ...customStyle.linkStyle\n      };\n    },\n\n    getTopicThemeStyle(props): TopicStyle {\n      const { topicKey, model } = props;\n      const visualLevel = model.getTopicVisualLevel(topicKey);\n      const theme = model.config.theme;\n      if (visualLevel === TopicVisualLevel.ROOT) return theme.rootTopic;\n      if (visualLevel === TopicVisualLevel.PRIMARY) return theme.primaryTopic;\n      return theme.normalTopic;\n    },\n\n    getRandomColor(props) {\n      const { topicKey } = props;\n      if (colorMap.has(topicKey)) return colorMap.get(topicKey);\n      const colors = [\n        '#00CC99',\n        '#FFEE88',\n        '#A167A5',\n        '#E5F993',\n        '#F5C396',\n        '#DB995A',\n        '#83BCFF',\n        '#ED7B84',\n        '#F92A82',\n        '#83BCFF'\n      ];\n      const color = colors[++colorIndex % colors.length];\n      colorMap.set(topicKey, color);\n      return color;\n    }\n  };\n}\n","import { OpType } from './operation';\nimport { FocusMode } from '@blink-mind/core';\n\nimport debug from 'debug';\n\nconst log = debug('plugin:event');\n\nexport function EventPlugin() {\n  return {\n    handleTopicClick(props) {\n      log('handleTopicClick');\n      const { controller, model, topicKey } = props;\n      if (\n        model.focusKey === topicKey &&\n        model.focusMode === FocusMode.EDITING_CONTENT\n      )\n        return;\n      controller.run('operation', {\n        ...props,\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.NORMAL\n      });\n    },\n\n    handleTopicDoubleClick(props) {\n      const { controller } = props;\n      controller.run('operation', {\n        ...props,\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.EDITING_CONTENT\n      });\n    },\n\n    handleTopicContextMenu(props) {\n      const { controller } = props;\n      controller.run('operation', {\n        ...props,\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.SHOW_POPUP\n      });\n    },\n\n    handleActiveModalClose(props) {\n      const { controller } = props;\n      const activeModalProps = controller.run('getActiveModalProps', props);\n      if (activeModalProps == null) return null;\n      if (activeModalProps.name === 'edit-desc') {\n        return function() {\n          controller.run('operation', {\n            ...props,\n            focusMode: FocusMode.NORMAL,\n            opType: OpType.FOCUS_TOPIC\n          });\n        };\n      }\n    }\n  };\n}\n","import { OpType } from './operation';\n\nexport interface HotKeyConfig {\n  combo: string;\n  onKeyDown: Function;\n}\n\nexport const HotKeyName = {\n  ADD_CHILD: 'ADD_CHILD',\n  ADD_SIBLING: 'ADD_SIBLING',\n  DELETE_TOPIC: 'DELETE_TOPIC',\n  EDIT_NOTES: 'EDIT_NOTES'\n};\n\nfunction op(opType: string, props) {\n  const { topicKey, model, controller } = props;\n  if (topicKey === undefined) {\n    props = { ...props, topicKey: model.focusKey };\n  }\n  controller.run('operation', { ...props, opType });\n}\n\nexport function HotKeyPlugin() {\n  return {\n    customizeHotKeys(props) {\n      const hotKeyMap = new Map<string, HotKeyConfig>([\n        [\n          HotKeyName.ADD_CHILD,\n          {\n            label: 'add child',\n            combo: 'tab',\n            onKeyDown: e => {\n              op(OpType.ADD_CHILD, props);\n            }\n          }\n        ],\n        [\n          HotKeyName.ADD_SIBLING,\n          {\n            label: 'add sibling',\n            combo: 'enter',\n            onKeyDown: e => {\n              op(OpType.ADD_SIBLING, props);\n            }\n          }\n        ],\n        [\n          HotKeyName.DELETE_TOPIC,\n          {\n            label: 'delete topic',\n            combo: 'del',\n            onKeyDown: e => {\n              op(OpType.DELETE_TOPIC, props);\n            }\n          }\n        ],\n        [\n          HotKeyName.EDIT_NOTES,\n          {\n            label: 'edit notes',\n            combo: 'alt + d',\n            onKeyDown: e => {\n              op(OpType.START_EDITING_DESC, props);\n            }\n          }\n        ]\n      ]);\n      return hotKeyMap;\n    }\n  };\n}\n","import * as React from 'react';\nimport styled from 'styled-components';\nimport { BaseWidget } from '../../../components/common';\nimport { contentRefKey } from '../../../utils';\nimport { BaseProps } from '../../../components/base-props';\nimport debug from 'debug';\nconst log = debug('node:topic-drop-effect');\n\nconst DropEffectSvg = styled.svg`\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 2;\n  pointer-events: none;\n`;\n\ninterface State {\n  content: any;\n}\n\nexport class TopicDropEffect extends BaseWidget<BaseProps, State> {\n  state = {\n    content: null\n  };\n\n  layout() {\n    const props = this.props;\n    const { getRef, model, controller } = this.props;\n    const targetProps = controller.run('getDragTargetProps', props);\n    const { key, dropDir } = targetProps;\n    log('layout', dropDir);\n\n    if (key === null) {\n      this.setState({\n        content: null\n      });\n      return;\n    }\n    let dropAreaRefKey;\n    if (dropDir === 'in') {\n      dropAreaRefKey = contentRefKey(key);\n    } else {\n      dropAreaRefKey = `dropArea-${dropDir}-${key}`;\n    }\n    const contentRect = getRef(dropAreaRefKey).getBoundingClientRect();\n    const svgRect = getRef('svg-drop-effect').getBoundingClientRect();\n    const padding = 3;\n    const x = contentRect.left - svgRect.left - padding;\n    const y = contentRect.top - svgRect.top - padding;\n    const width = contentRect.width + 2 * padding;\n    const height = contentRect.height + 2 * padding;\n\n    this.setState({\n      content: (\n        <g>\n          <rect\n            x={x}\n            y={y}\n            width={width}\n            height={height}\n            fill=\"none\"\n            stroke={model.config.theme.highlightColor}\n            strokeDasharray=\"5,5\"\n            strokeWidth={2}\n          />\n        </g>\n      )\n    });\n  }\n\n  render() {\n    const { saveRef } = this.props;\n    return (\n      <DropEffectSvg ref={saveRef('svg-drop-effect')}>\n        {this.state.content}\n      </DropEffectSvg>\n    );\n  }\n}\n","import * as React from 'react';\nimport styled from 'styled-components';\nimport { OpType } from './operation';\nimport {\n  FocusMode,\n  getRelationship,\n  TopicRelationship\n} from '@blink-mind/core';\nimport debug from 'debug';\nimport { TopicDropEffect } from './react/components/topic-drop-effect';\nimport { contentRefKey } from '../utils';\nconst log = debug('plugin:drag-and-drop');\nconst DropArea = styled.div`\n  height: ${props => `${props.height}px`};\n  width: 100%;\n  margin: 5px 0px;\n`;\n\nconst DropEffects = styled.svg``;\nexport function DragAndDrop() {\n  let dragTargetKey: KeyType = null;\n  let dragTargetDir: string = null;\n\n  return {\n    renderTopicDropArea(props) {\n      const { topicKey, dropDir, saveRef, controller, model } = props;\n      const onDragEnter = ev => {\n        log('onDragEnter', topicKey, dropDir);\n        controller.run('handleTopicDragEnter', { ...props, ev, dropDir });\n      };\n      const onDragLeave = ev => {\n        log('onDragLeave', topicKey, dropDir);\n        controller.run('handleTopicDragLeave', { ...props, ev, dropDir });\n      };\n      const onDragOver = ev => {\n        ev.preventDefault();\n      };\n      const onDrop = ev => {\n        log('onDrop', topicKey, dropDir);\n        controller.run('handleTopicDrop', { ...props, ev, dropDir });\n      };\n      const eventHandlers = {\n        onDragEnter,\n        onDragLeave,\n        onDragOver,\n        onDrop\n      };\n      return (\n        <DropArea\n          height={model.config.theme.marginV / 2}\n          ref={saveRef(`dropArea-${dropDir}-${topicKey}`)}\n          {...eventHandlers}\n        />\n      );\n    },\n\n    renderDragAndDropEffect(props) {\n      log('renderDragAndDropEffect');\n      const { saveRef } = props;\n      return (\n        <TopicDropEffect\n          ref={saveRef('drop-effect')}\n          {...props}\n        ></TopicDropEffect>\n      );\n    },\n\n    // getTopicDropEventHandlers(props) {\n    //   const { dropDir, controller, topicKey } = props;\n    //   const onDragEnter = ev => {\n    //     log('onDragEnter', topicKey, dropDir);\n    //     controller.run('handleTopicDragEnter', { ...props, ev, dropDir });\n    //   };\n    //   const onDragLeave = ev => {\n    //     log('onDragLeave', topicKey, dropDir);\n    //     controller.run('handleTopicDragLeave', { ...props, ev, dropDir });\n    //   };\n    //   const onDragOver = ev => {\n    //     ev.preventDefault();\n    //   };\n    //   const onDrop = ev => {\n    //     log('onDrop', topicKey, dropDir);\n    //     controller.run('handleTopicDrop', { ...props, ev, dropDir });\n    //   };\n    //   const eventHandlers = {\n    //     onDragEnter,\n    //     onDragLeave,\n    //     onDragOver,\n    //     onDrop\n    //   };\n    //   return eventHandlers;\n    // },\n\n    getDragTargetProps(props) {\n      return {\n        key: dragTargetKey,\n        dropDir: dragTargetDir\n      };\n    },\n\n    handleTopicDragStart(props) {\n      const { controller, ev } = props;\n      ev.stopPropagation();\n      controller.run('operation', {\n        ...props,\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.DRAGGING\n      });\n    },\n\n    canDrop(props) {\n      const { srcKey, dstKey, model, dropDir } = props;\n      if (\n        srcKey === model.editorRootTopicKey ||\n        srcKey === dstKey ||\n        getRelationship(model, srcKey, dstKey) === TopicRelationship.ANCESTOR\n      )\n        return false;\n      if (dstKey === model.editorRootTopicKey && dropDir !== 'in') return false;\n\n      const srcTopic = model.getTopic(srcKey);\n      if (srcTopic.parentKey === dstKey && dropDir === 'in') return false;\n      return true;\n    },\n\n    handleTopicDragEnter(props) {\n      const { dropDir, topicKey, controller, model, ev } = props;\n      log('handleTopicDragEnter:', topicKey, dropDir);\n      const canDrop = controller.run('canDrop', {\n        ...props,\n        srcKey: model.focusKey,\n        dstKey: topicKey\n      });\n      if (canDrop) {\n        dragTargetKey = topicKey;\n        dragTargetDir = dropDir;\n        controller.change(model);\n      }\n    },\n\n    handleTopicDragLeave(props) {\n      const { controller, model, topicKey, dropDir, getRef, ev } = props;\n      const relatedTarget = ev.nativeEvent.relatedTarget;\n      log('handleTopicDragLeave:', topicKey, dropDir);\n      const content = getRef(contentRefKey(topicKey));\n      if (content == relatedTarget || content.contains(relatedTarget)) {\n        return;\n      }\n      dragTargetKey = null;\n      dragTargetDir = null;\n      controller.change(model);\n    },\n\n    handleTopicDrop(props) {\n      log('handleTopicDrop');\n      const { controller, topicKey, model } = props;\n      props = { ...props, srcKey: model.focusKey, dstKey: topicKey };\n\n      dragTargetKey = null;\n      dragTargetDir = null;\n      if (controller.run('canDrop', props)) {\n        controller.run('operation', {\n          ...props,\n          opType: OpType.DRAG_AND_DROP\n        });\n      }\n    }\n  };\n}\n","import { ReactPlugin } from './react';\nimport { LayoutPlugin } from './layout';\nimport { OperationPlugin } from './operation';\nimport { StylePlugin } from './style';\nimport { EventPlugin } from './event';\nimport { HotKeyPlugin } from './hotkey';\nimport { DragAndDrop } from './drag-and-drop';\n\nexport function DefaultPlugin() {\n  return [\n    ReactPlugin(),\n    LayoutPlugin(),\n    OperationPlugin(),\n    StylePlugin(),\n    EventPlugin(),\n    HotKeyPlugin(),\n    DragAndDrop()\n  ];\n}\n","import * as React from 'react';\nimport memoizeOne from 'memoize-one';\nimport { Hotkey, Hotkeys, HotkeysTarget } from '@blueprintjs/core';\nimport { Model, Controller, OnChangeFunction } from '@blink-mind/core';\nimport { DefaultPlugin } from '../plugins';\nimport './diagram.css';\nimport '@blueprintjs/core/lib/css/blueprint.css';\nimport debug from 'debug';\nconst log = debug('node:Diagram');\n\ninterface Props {\n  model: Model;\n  onChange: OnChangeFunction;\n  commands?: any;\n  plugins?: any;\n}\n\n@HotkeysTarget\nexport class Diagram extends React.Component<Props> {\n  controller: Controller;\n\n  getDiagramProps() {\n    return this.diagramProps;\n  }\n\n  diagramProps;\n\n  resolveController = memoizeOne((plugins = [], commands, TheDefaultPlugin) => {\n    const defaultPlugin = TheDefaultPlugin();\n    this.controller = new Controller({\n      plugins: [plugins, defaultPlugin],\n      commands,\n      construct: false,\n      onChange: this.props.onChange\n    });\n    this.controller.run('onConstruct');\n  });\n\n  renderHotkeys() {\n    log(`renderHotkeys`);\n    const { controller } = this.diagramProps;\n    const hotKeys = controller.run('customizeHotKeys', this.diagramProps);\n    if (hotKeys === null) return null;\n    if (!(hotKeys instanceof Map)) {\n      throw new TypeError('customizeHotKeys must return a Map');\n    }\n    log(hotKeys);\n    const children = [];\n    hotKeys.forEach((v, k) => {\n      log(k, v);\n      children.push(<Hotkey key={k} {...v} global />);\n    });\n    return <Hotkeys>{children}</Hotkeys>;\n  }\n\n  render() {\n    const { commands, plugins, model } = this.props;\n    this.resolveController(plugins, commands, DefaultPlugin);\n    this.diagramProps = {\n      ...this.props,\n      controller: this.controller,\n      model,\n      diagram: this\n    };\n    return this.controller.run('renderDiagram', this.diagramProps);\n  }\n}\n"],"names":["React.PureComponent","React.Component","styled","React.createElement","log","ModelModifier","FocusMode","BlockType","List","Stack","TopicDirection","ContextMenuTarget","DiagramLayoutType","Menu","Icon","css","Select","MenuItem","isEqual","Button","Popover","SketchPicker","Dialog","Classes","NodeContent","ThemeProvider","React.Fragment","TopicVisualLevel","getRelationship","TopicRelationship","Controller","Hotkey","Hotkeys","HotkeysTarget"],"mappings":"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"}